<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Quick guide on UNIX task scheduling with at and batch command | JPrasojo's Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="keywords" content="" />
    <meta name="author" content="Lintang JP" />
    <meta name="kittycheck_rumble" content="true" />
    <meta name="kittycheck_position" content="top=60,right=60" />

    <!-- Le styles -->
    <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="/theme/css/font-awesome.css" rel="stylesheet">
    <link href="/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/theme/img/favicon.ico">
    <link rel="apple-touch-icon" href="/theme/img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/theme/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/theme/img/apple-touch-icon-114x114.png">

    <link href="/" type="application/atom+xml" rel="alternate" title="JPrasojo's Blog ATOM Feed" />
  </head>
  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">JPrasojo's Blog </a>
          <div class="nav-collapse">
            <ul class="nav">
                <li class="divider-vertical"></li>
                <li class="active">
                  <a href="/category/blog.html">
						        <i class="icon-folder-open icon-large"></i>blog
					         </a>
                </li>
              <ul class="nav pull-right">
                    <li><a href="/archives.html"><i class="icon-th-list"></i>Archives</a></li>
              </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="span8" id="content">
<div class="row">
    <div class="span2">
        <div class="well">
<footer class="post-info">
<abbr class="published" title="2009-05-18T00:00:00+01:00">
    <i class="icon-calendar"></i>&nbsp;Mon 18 May 2009
</abbr>
<br/><a href="/author/lintang-jp.html"><i class="icon-user"></i>&nbsp;Lintang JP</a>


<br/>
	&nbsp;&nbsp;<a href="/tag/tips-unix-linux-stuff.html" class="label"><i class="icon-tag"></i>&nbsp;Tips Unix Linux stuff</a>
</footer><!-- /.post-info -->        </div>
    </div>
    <div class="span6">
<section id="content" class="well">
    <article>
        <header>
            <h1>
                <a href=""
                        rel="bookmark"
                        title="Permalink to Quick guide on UNIX task scheduling with at and batch command">
                        Quick guide on UNIX task scheduling with at and batch command
                </a>
            </h1>
        </header>
        <div class="entry-content">

        <p>While task scheduling in UNIX commonly uses Crontab facilities, UNIX based system (actually, Windows provide it too, at.exe) also provide at command. Both related to the same area, task scheduling. While Crontab aims to schedule a recurring command (every minutes, every month, every week, etc), at command aims to schedule a task that run once, with specific time arguments. Here’s one example of how we can schedule a task with at command:</p>
<p>$ at now 1 hour &amp;1 &gt; outfile | mailx mygroup
!
commands will be executed using /bin/tcsh
job 1242637613.s at Mon May 18 16:06:53 2009</p>
<p>As we can see from the example above, we want to schedule a task to be executed 1 hour from now, and the task to be executed is diff file1 file2 2&gt;&amp;1 &gt; outfile | mailx mygroup. The at command then returns the job id, which we will able to list all the queueing at command using atq or at –l below:</p>
<p>$ atq
Rank Execution Date Owner Job Queue Job Name
1st May 18, 2009 17:06 minsat 1242637774.a a stdin</p>
<p>$ at -l
1242637774.a Mon May 18 16:18:45 2009</p>
<p>From above we can see that there are only 1 jobs queuing at queue named ‘a’ (this is special queue name for at, and it is used to distinguish between the job executed by at and batch command). We can also see that the execution time will be May 18, 2009 17:06.</p>
<p>And to cancel the scheduled at command, we use atrm or at –r command as follows:</p>
<p>$ atrm 1242637774.a
1242637774.a: removed</p>
<p>$ at -r 1242637774.a
1242637774.a: removed</p>
<p>There are lots of other parameter we can use for describing the time parameter and how to execute the at command which is I found it quite ‘human readable’. Here’s some list of other possible parameter we can use:</p>
<p>1. Direct time
$ at 01.30
$ at 0815am Jan 24
$ at 5 pm FRIday
2. Now keyword
$ at now 1 minutes
$ at now 1 hours
$ at now " 1day"
3. Tomorrow keyword
$ at 0830 tomorrow
4. Noon keyword
$ at noon tomorrow
5. Midnight keyword
$ at midnight tomorrow
6. Week keyword
$ at 2pm next week
7. Piped with other command
$ echo "mail -s 'REMINDER: Task Scheduler samples' lintang.jp@gmail.com" | at '5/18/2009 10:00AM'
8. Putting the job inside a file
$ at –f runScript.sh now 1 hour
9. Sending an email after the job is completed
$ at –m –f runScript.sh now 1 hour
10. Using another shell instead of the user’s default shell for execution
$ at –c –f runScript.sh now 1 week // C Shell
$ at –k –f runScript.sh now 1 week // Korn Shell
$ at –s –f runScript.sh now 1 week // Bourne Shell</p>
<p>Several behaviors and conditions that must be known when running at command as follows:</p>
<p>1. All environment variables, current working directory, file creation mask, and system resource limits during at utility execution will be retained and used when the at job is executed. So it’s different with Crontab where we have to set our environment variables manually to be called inside our script execution.
2. The default shell environment to be used during execution is the user’s default shell, listed in /etc/passwd.
3. Any users that is allowed or forbidden to use at command are listed in the following file :</p>
<p>1. /usr/lib/cron/at.deny // denied user
2. /usr/lib/cron/at.allow // allowed user</p>
<p>If the file does not exist, for example: at.allow file does not exist, means that all users are allowed to use at command.</p>
<p>While batch command is similar with at -q b -m now commands. Meaning that the batch command will use different queue with at (special queue named ‘b’), and by default it will send a report via email. It will also execute right away. If the queue is full, then the command will have to wait to be executed one by one.</p>
<p>Resource : 1. Unix at man pages, with some slang modifications :p</p>
<p>Fiuh, alhamdulillah, that was hard to wrote :D</p>
        </div><!-- /.entry-content -->
    </article>
</section>
</div>
</div>
        </div><!--/span-->
        <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><div><i class="icon-external-link"></i><a href="http://getpelican.com/">Pelican</a></div></li>
    <li><div><i class="icon-external-link"></i><a href="http://python.org/">Python.org</a></div></li>
    <li><div><i class="icon-external-link"></i><a href="http://jinja.pocoo.org/">Jinja2</a></div></li>
    <li><div><i class="icon-external-link"></i><a href="#">You can modify those links in your config file</a></div></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
<li><a href="/" rel="alternate"><i class="icon-bookmark icon-large"></i>atom feed</a></li>
    <li><a href="#"><i class="icon-You can add links in your config file-sign icon-large"></i>You can add links in your config file</a></li>
    <li><a href="#"><i class="icon-Another social link-sign icon-large"></i>Another social link</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="/category/blog.html">
    <i class="icon-folder-open icon-large"></i>blog
</a>
</li>

<li class="nav-header"><a href="/tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>
    <li class="tag-4">
        <a href="/tag/linux-stuff.html">
            <i class="icon-tag icon-large"></i>Linux stuff
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/telco-billing-cdma-450-3g.html">
            <i class="icon-tag icon-large"></i>Telco Billing CDMA 450 3G
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/travel.html">
            <i class="icon-tag icon-large"></i>Travel
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/ruby-dsl-linux-stuff.html">
            <i class="icon-tag icon-large"></i>Ruby DSL Linux stuff
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/tips-unix-linux-stuff.html">
            <i class="icon-tag icon-large"></i>Tips Unix Linux stuff
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/jumpstart-unix-linux-stuff-solaris.html">
            <i class="icon-tag icon-large"></i>jumpstart Unix Linux stuff solaris
        </a>
    </li>
    <li class="tag-3">
        <a href="/tag/telco-billing.html">
            <i class="icon-tag icon-large"></i>Telco Billing
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/broadband-at-home-internet-3g.html">
            <i class="icon-tag icon-large"></i>Broadband at home Internet 3G
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/cms.html">
            <i class="icon-tag icon-large"></i>CMS
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/wordpress-verify-google-webmaster-internet.html">
            <i class="icon-tag icon-large"></i>wordpress verify google webmaster Internet
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/os-linux-stuff-opensolaris-solaris.html">
            <i class="icon-tag icon-large"></i>OS Linux stuff OpenSolaris solaris
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/tips-unix-linux-stuff-web-server-nginx.html">
            <i class="icon-tag icon-large"></i>Tips Unix Linux stuff Web Server Nginx
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/laptop.html">
            <i class="icon-tag icon-large"></i>Laptop
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/renungan.html">
            <i class="icon-tag icon-large"></i>Renungan
        </a>
    </li>
    <li class="tag-1">
        <a href="/tag/.html">
            <i class="icon-tag icon-large"></i>
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/tips.html">
            <i class="icon-tag icon-large"></i>Tips
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/atutor-unix-linux-stuff-web-server-internet-nginx.html">
            <i class="icon-tag icon-large"></i>aTutor Unix Linux stuff Web Server Internet Nginx
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/family.html">
            <i class="icon-tag icon-large"></i>Family
        </a>
    </li>
    <li class="tag-4">
        <a href="/tag/interconnect-telekomunikasi-telco-billing-interkoneksi.html">
            <i class="icon-tag icon-large"></i>Interconnect Telekomunikasi Telco Billing Interkoneksi
        </a>
    </li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

    </div><!--/.fluid-container-->


    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/theme/js/jquery-1.7.2.min.js"></script>
    <script src="/theme/js/bootstrap.min.js"></script>
  </body>
</html>