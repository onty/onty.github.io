<!doctype html>
<html lang="en">

<head>

    <title>Apache Httpd and Tomcat integration using mod_jk, part 1 - JPrasojo's blog</title>

    <!-- meta -->
    <meta charset="utf-8" />
    <meta name="author" content="Lintang JP" />
    <meta name="dc.language" content="en" />
    <meta name="dc.license" content="">

    <!-- favicon -->
    <link rel="icon" href="/theme/favicon.ico" type="image/x-icon">

    <!-- newsfeeds -->

    <!-- assets -->
    <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
   
    <link href="https://fonts.googleapis.com/css?family=Linden+Hill:400,400italic" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Anonymous+Pro' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/theme/css/simplegrid.css" type="text/css">
    <link rel="stylesheet" href="/theme/css/main.css" type="text/css">
    <link rel="stylesheet" href="/theme/css/pygments.css" type="text/css">
    <!--[if lt IE 8]>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet" type="text/css">
    <![endif]-->
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" type="text/css">

</head>

<body>

   <div class="grid grid-pad">
     <div class="col-1-1">        
       <ul id="mainnav">
          <li><a href="">home</a></li>
          <li><a href="/pages/hello-world.html">About</a></li>
       </ul>
       <div id="blogtitle"><a href="">JPrasojo's blog</a></div>
       <div id="blogsubtitle"><a href=""></a></div>
     </div>
    </div>

    <div class="grid grid-pad">
       <div id="left-side" class="col-8-12">
          <section id="content" class="hyphenate">

    <h1 class="title">Apache Httpd and Tomcat integration using mod_jk, part 1</h1>

        <div class="date">
            <p>written on Sun 03 June 2007
            by <a rel="author" href="/pages/aboutme.html">Lintang JP</a></p>
        </div>

    <div class="clearboth"><p>In my other blog, I've wrote about howto use mod_jk2 to integrate httpd and tomcat. The article can be accesed <a href="http://www.jroller.com/page/JPrasojo/?anchor=setup_tomcat_clustering_and_load">here</a> and <a href="http://www.jroller.com/page/JPrasojo/?anchor=setup_tomcat_clustering_and_load1">here</a>.
Now, since mod_jk2 has not supported again by apache-tomcat-connector developers, so in this article I will use mod_jk. I'm using :</p>
<ul>
<li>httpd-2.2.4, can be downloaded <a href="http://apache.the.net.id/httpd/httpd-2.2.4.tar.gz">here</a></li>
<li>tomcat-5.2.23, can be downloaded <a href="http://apache.the.net.id/tomcat/tomcat-5/v5.5.23/bin/apache-tomcat-5.5.23.tar.gz">here</a></li>
<li>tomcat-connector, can be downloaded <a href="http://apache.the.net.id/tomcat/tomcat-connectors/jk/binaries/linux/jk-1.2.21/mod_jk-1.2.21-apache-2.2.x-linux-i686.so">here</a></li>
</ul>
<p>I prefer apache.the.net.id since this is the nearest mirror from Indonesia. O ya, Im using Kubuntu Feisty Fawn in my laptop.
First, we install the httpd-2.2.4 first. Unzip it, place it at some directory you like. In my environment, my user has full access to /opt directory, so I'm using it.
onty@phoenix:/opt$ gunzip httpd-2.2.4.tar.gz
onty@phoenix:/opt$ tar -xvf httpd-2.2.4.tar
onty@phoenix:/opt$ mv httpd-2.2.4 httpd-2.2.4-src
onty@phoenix:/opt$ cd httpd-2.2.4-src
Configure, put the result in /opt/httpd-2.2.4, enable shared object, enable cgi support. Enabling shared object makes us able to load dynamic shared object library. We're using mod_jk's shared object, so we need to enable apache to support dynamic shared object library. This also usefull if you want to enable your apache httpd server to serve PHP also. Same like this, you would also compile PHP as shared object, and then load it dynamically to apache httpd using LoadModule syntax in your httpd.conf .
onty@phoenix:/opt/httpd-2.2.4-src$ ./configure --prefix=/opt/httpd-2.2.4 --enable-so --enable-cgi
onty@phoenix:/opt/httpd-2.2.4-src$ make  onty@phoenix:/opt/httpd-2.2.4-src$ make install
Now, try to start it using root :
onty@phoenix:/opt/httpd-2.2.4-src$ cd /opt/httpd-2.2.4
onty@phoenix:/opt/httpd-2.2.4$ su -
root@phoenix:/opt/httpd-2.2.4# bin/apachectl start
If everything ok, you should be able to point your browser to http://localhost now, and see if you can read any "It works" there.
OK, now we continue to install the tomcat connector. Apache has provided us with the binary version of the connector. As mentioned in before, we should now already download it. I'm using mod_jk-1.2.21-apache-2.2.x-linux-i686.so. What we need to do is just load this shared object so that can be used by apache, that simple ? yes :D
Edit your httpd.conf, add this line :
Include conf/extra/mod_jk.conf
This is new style from apache that makes us easier to maintain our configuration file in modular basis.
Now create a new file in conf/extra/ name it mod_jk.conf.
--------------------------------------------- mod_jk.conf -----------------------------------
JkWorkersFile /opt/httpd-2.2.4/conf/workers.properties
JkShmFile /var/log/httpd/mod_jk.shm
JkLogFile /opt/httpd-2.2.4/logs/mod_jk.log
JkLogLevel info
JkLogStampFormat "[%a %b %d %H:%M:%S %Y]"
JkMount /tomcat-docs/* router</p>
<p>JkMount jkstatus
Order deny,allow
Deny from all
Allow from 127.0.0.1</p>
<p>-------------------------------------------------------
From the configuration file, we can see that :
We will place the log file in /opt/httpd-2.2.4/logs/mod_jk.log.
We will configure the connectors with a file named workers.properties located in /opt/httpd-2.2.4/conf .
We will have shared file that will be used by apache and tomcat, located in /var/log/httpd/mod_jk.shm. If the directory /var/log/httpd doesnt exist yet, we should create it first using root user.
The logger level will be INFO.
We will map /tomcat-docs/ request in httpd to be handled by tomcat, so make sure that this webapp exist in tomcat. By default if you download tomcat, this webapp is already exist. Later you can change it to your own webapp. And this request will be handled by a worker named 'router'.
Last one is for jkmanager monitoring tools. There will be new context path named /jkmanager/ that will show us status for our jk_module. This context path only allowed to be accessed from 127.0.0.1 (localhost).</p>
<p>Ok, now we need to create workers.properties in conf/ directory. See part 2 of this post.</p></div>

        <div class="tags">
            <p>This entry was tagged on  
                <a href="/tag/.html">#</a></p>
        </div>


          </section>
       </div>

       <div id="right-side" class="col-1-12">&nbsp;</div>
       <div id="right-side" class="col-3-12">

<div class="section-container">
   <h3>Blogroll</h3>
   <ul>
      <li><a href="http://getpelican.com/" target="_blank">Pelican <i class="fa fa-globe fa-fw"></i></a></li>
      <li><a href="http://python.org/" target="_blank">Python.org <i class="fa fa-globe fa-fw"></i></a></li>
      <li><a href="https://vhynaulia.wordpress.com/" target="_blank">Blognya TePot <i class="fa fa-globe fa-fw"></i></a></li>
      <li><a href="http://theprasojos.wordpress.com" target="_blank">Theprasojos Family <i class="fa fa-globe fa-fw"></i></a></li>
   </ul>
</div>

<div class="section-container">
   <h3>Social Network</h3>
   <ul>
      <li>
        <a href="https://twitter.com/jprasojo" target="_blank">Twitter&nbsp;
           <i class="fa fa-twitter fa-fw"></i>
        </a>
      </li>
      <li>
        <a href="https://www.linkedin.com/in/lintangprasojo" target="_blank">Linkedin&nbsp;
           <i class="fa fa-linkedin fa-fw"></i>
        </a>
      </li>
   </ul>
</div>

<div class="section-container">
   <h3>Categories</h3>
   <ul>
        <li><a href="/category/family.html">Family <i class="fa fa-folder-open fa-fw"></i></a></li>
        <li><a href="/category/java.html">Java <i class="fa fa-folder-open fa-fw"></i></a></li>
        <li><a href="/category/renungan.html">Renungan <i class="fa fa-folder-open fa-fw"></i></a></li>
        <li><a href="/category/telco.html">Telco <i class="fa fa-folder-open fa-fw"></i></a></li>
        <li><a href="/category/travelling.html">Travelling <i class="fa fa-folder-open fa-fw"></i></a></li>
        <li><a href="/category/unixlinux.html">Unix/Linux <i class="fa fa-folder-open fa-fw"></i></a></li>
   </ul>
</div>

<div class="section-container">
   <h3>Tags</h3>
   <ul class="tagcloud">
        <li class="tag-4"><a href="/tag/merdeka-walk.html">#merdeka_walk</a></li>
        <li class="tag-4"><a href="/tag/tips.html">#Tips</a></li>
        <li class="tag-4"><a href="/tag/martebe.html">#martebe</a></li>
        <li class="tag-4"><a href="/tag/tiara-medan.html">#tiara_medan</a></li>
        <li class="tag-4"><a href="/tag/charging-system.html">#Charging_System</a></li>
        <li class="tag-4"><a href="/tag/harare.html">#harare</a></li>
        <li class="tag-4"><a href="/tag/wordpress-verify-google-webmaster-internet.html">#wordpress_verify_google_webmaster_Internet</a></li>
        <li class="tag-4"><a href="/tag/broadband-at-home-internet-3g.html">#Broadband_at_home_Internet_3G</a></li>
        <li class="tag-4"><a href="/tag/intelligent-network.html">#Intelligent_Network</a></li>
        <li class="tag-4"><a href="/tag/indonesian-embassy.html">#indonesian_embassy</a></li>
        <li class="tag-4"><a href="/tag/family.html">#Family</a></li>
        <li class="tag-4"><a href="/tag/laptop.html">#Laptop</a></li>
        <li class="tag-4"><a href="/tag/telco-billing-cdma-450-3g.html">#Telco_Billing_CDMA_450_3G</a></li>
        <li class="tag-4"><a href="/tag/embassy.html">#embassy</a></li>
        <li class="tag-4"><a href="/tag/tips-unix-linux-stuff-web-server-nginx.html">#Tips_Unix_Linux_stuff_Web_Server_Nginx</a></li>
        <li class="tag-4"><a href="/tag/travel.html">#Travel</a></li>
        <li class="tag-4"><a href="/tag/jumpstart-unix-linux-stuff-solaris.html">#jumpstart_Unix_Linux_stuff_solaris</a></li>
        <li class="tag-4"><a href="/tag/prepaid-system.html">#Prepaid_System</a></li>
        <li class="tag-4"><a href="/tag/ruby-dsl-linux-stuff.html">#Ruby_DSL_Linux_stuff</a></li>
        <li class="tag-4"><a href="/tag/grand-angkasa.html">#grand_angkasa</a></li>
        <li class="tag-3"><a href="/tag/renungan.html">#Renungan</a></li>
        <li class="tag-4"><a href="/tag/medan.html">#medan</a></li>
        <li class="tag-4"><a href="/tag/os-linux-stuff-opensolaris-solaris.html">#OS_Linux_stuff_OpenSolaris_solaris</a></li>
        <li class="tag-4"><a href="/tag/cms.html">#CMS</a></li>
        <li class="tag-3"><a href="/tag/telco-billing.html">#Telco_Billing</a></li>
        <li class="tag-1"><a href="/tag/.html">#</a></li>
        <li class="tag-4"><a href="/tag/grand-angkasa-medan.html">#grand_angkasa_medan</a></li>
        <li class="tag-4"><a href="/tag/lembur-kuring-medan.html">#lembur_kuring_medan</a></li>
        <li class="tag-4"><a href="/tag/interconnect-telekomunikasi-telco-billing-interkoneksi.html">#Interconnect_Telekomunikasi_Telco_Billing_Interkoneksi</a></li>
        <li class="tag-4"><a href="/tag/tips-unix-linux-stuff.html">#Tips_Unix_Linux_stuff</a></li>
        <li class="tag-4"><a href="/tag/linux-stuff.html">#Linux_stuff</a></li>
        <li class="tag-4"><a href="/tag/ocs.html">#OCS</a></li>
        <li class="tag-4"><a href="/tag/ireland.html">#Ireland</a></li>
        <li class="tag-4"><a href="/tag/zimbabwe.html">#zimbabwe</a></li>
        <li class="tag-4"><a href="/tag/brastagi.html">#brastagi</a></li>
        <li class="tag-4"><a href="/tag/atutor-unix-linux-stuff-web-server-internet-nginx.html">#aTutor_Unix_Linux_stuff_Web_Server_Internet_Nginx</a></li>
        <li class="tag-4"><a href="/tag/green-card.html">#Green_Card</a></li>
        <li class="tag-4"><a href="/tag/visa.html">#VISA</a></li>
   </ul>
</div>



          <div class="section-container" id="copyright">
             <p>This Blog generated by <a href="http://getpelican.com/">Pelican</a> using <a href="https://github.com/habibillah/pujangga">Pujangga</a> theme. All content on this blog, unless stated otherwise, is licensed under the <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0 International license</a>.</p>
          </div>
       </div>
    </div>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', '']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
 

    <script type="text/javascript" src="/theme/js/hyphenator.js"></script>
    <script type="text/javascript">
      Hyphenator.config({
          donthyphenateclassname: 'docutils',
          useCSS3hyphenation: true
      });
      Hyphenator.run();
    </script>

</body>

</html>