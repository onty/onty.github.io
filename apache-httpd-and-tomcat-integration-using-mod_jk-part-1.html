<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <title>JPrasojo's blog</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" id="responsive-style-css"  href='/theme/css/style.css' type="text/css" media="all" />
    <link rel="stylesheet" id="responsive-style-css"  href='/theme/css/highlight.css' type="text/css" media="all" />
    
</head>

<body id="index" class="blog">
<div id="container" class="hfeed">
    <header id="header" >
        <div id="logo">
                <h1><img src="/theme/image/default-logo.png" width="300" height="100" alt="小铱的故事" />
                JPrasojo's blog</h1>
        </div> <!-- /#logo-->
        <nav id="menu" class="main-nav"><ul class="menu">
            <li><a href="/pages/hello-world.html">About</a></li>

        </ul></nav><!-- /#menu -->
    </header>
    <section id="wrapper" class="clearfix">
        <section id="content" class="grid col-620" >
                <section class="breadcrumb-list">
<a href="">Blog</a> ›<a href="category/unixlinux.html">Unix/Linux</a> ›Apache Httpd and Tomcat integration using mod_jk, part 1
                </section>


<section id="post" class="post hentry">
    <header>
    <h2 class="post-title" >Apache Httpd and Tomcat integration using mod_jk, part 1</h2>
    
    <div class="post-meta">
        <span class="meta-prep">Post in</span>
        <abbr class="date" title="2007-06-03T00:00:00+01:00"> 
            <a href="/archive/2007/Jun/index.html">Sun 03 June 2007 </a>
        </abbr>
        <span class="meta-prep"> |Tags</span>
                <a href="/tag/.html"></a>
        <!-- TOBE COMMENTS -->
    </div>
    </header>
    <div class="post-entry">
        <p>In my other blog, I've wrote about howto use mod_jk2 to integrate httpd and tomcat. The article can be accesed <a href="http://www.jroller.com/page/JPrasojo/?anchor=setup_tomcat_clustering_and_load">here</a> and <a href="http://www.jroller.com/page/JPrasojo/?anchor=setup_tomcat_clustering_and_load1">here</a>.
Now, since mod_jk2 has not supported again by apache-tomcat-connector developers, so in this article I will use mod_jk. I'm using :</p>
<ul>
<li>httpd-2.2.4, can be downloaded <a href="http://apache.the.net.id/httpd/httpd-2.2.4.tar.gz">here</a></li>
<li>tomcat-5.2.23, can be downloaded <a href="http://apache.the.net.id/tomcat/tomcat-5/v5.5.23/bin/apache-tomcat-5.5.23.tar.gz">here</a></li>
<li>tomcat-connector, can be downloaded <a href="http://apache.the.net.id/tomcat/tomcat-connectors/jk/binaries/linux/jk-1.2.21/mod_jk-1.2.21-apache-2.2.x-linux-i686.so">here</a></li>
</ul>
<p>I prefer apache.the.net.id since this is the nearest mirror from Indonesia. O ya, Im using Kubuntu Feisty Fawn in my laptop.
First, we install the httpd-2.2.4 first. Unzip it, place it at some directory you like. In my environment, my user has full access to /opt directory, so I'm using it.
onty@phoenix:/opt$ gunzip httpd-2.2.4.tar.gz
onty@phoenix:/opt$ tar -xvf httpd-2.2.4.tar
onty@phoenix:/opt$ mv httpd-2.2.4 httpd-2.2.4-src
onty@phoenix:/opt$ cd httpd-2.2.4-src
Configure, put the result in /opt/httpd-2.2.4, enable shared object, enable cgi support. Enabling shared object makes us able to load dynamic shared object library. We're using mod_jk's shared object, so we need to enable apache to support dynamic shared object library. This also usefull if you want to enable your apache httpd server to serve PHP also. Same like this, you would also compile PHP as shared object, and then load it dynamically to apache httpd using LoadModule syntax in your httpd.conf .
onty@phoenix:/opt/httpd-2.2.4-src$ ./configure --prefix=/opt/httpd-2.2.4 --enable-so --enable-cgi
onty@phoenix:/opt/httpd-2.2.4-src$ make  onty@phoenix:/opt/httpd-2.2.4-src$ make install
Now, try to start it using root :
onty@phoenix:/opt/httpd-2.2.4-src$ cd /opt/httpd-2.2.4
onty@phoenix:/opt/httpd-2.2.4$ su -
root@phoenix:/opt/httpd-2.2.4# bin/apachectl start
If everything ok, you should be able to point your browser to http://localhost now, and see if you can read any "It works" there.
OK, now we continue to install the tomcat connector. Apache has provided us with the binary version of the connector. As mentioned in before, we should now already download it. I'm using mod_jk-1.2.21-apache-2.2.x-linux-i686.so. What we need to do is just load this shared object so that can be used by apache, that simple ? yes :D
Edit your httpd.conf, add this line :
Include conf/extra/mod_jk.conf
This is new style from apache that makes us easier to maintain our configuration file in modular basis.
Now create a new file in conf/extra/ name it mod_jk.conf.
--------------------------------------------- mod_jk.conf -----------------------------------
JkWorkersFile /opt/httpd-2.2.4/conf/workers.properties
JkShmFile /var/log/httpd/mod_jk.shm
JkLogFile /opt/httpd-2.2.4/logs/mod_jk.log
JkLogLevel info
JkLogStampFormat "[%a %b %d %H:%M:%S %Y]"
JkMount /tomcat-docs/* router</p>
<p>JkMount jkstatus
Order deny,allow
Deny from all
Allow from 127.0.0.1</p>
<p>-------------------------------------------------------
From the configuration file, we can see that :
We will place the log file in /opt/httpd-2.2.4/logs/mod_jk.log.
We will configure the connectors with a file named workers.properties located in /opt/httpd-2.2.4/conf .
We will have shared file that will be used by apache and tomcat, located in /var/log/httpd/mod_jk.shm. If the directory /var/log/httpd doesnt exist yet, we should create it first using root user.
The logger level will be INFO.
We will map /tomcat-docs/ request in httpd to be handled by tomcat, so make sure that this webapp exist in tomcat. By default if you download tomcat, this webapp is already exist. Later you can change it to your own webapp. And this request will be handled by a worker named 'router'.
Last one is for jkmanager monitoring tools. There will be new context path named /jkmanager/ that will show us status for our jk_module. This context path only allowed to be accessed from 127.0.0.1 (localhost).</p>
<p>Ok, now we need to create workers.properties in conf/ directory. See part 2 of this post.</p>
    </div><!-- /.entry-content -->
    <footer class="post-meta">
        <span class="meta-prep">Category:</span>
        <abbr class="category">
            <a href="/category/unixlinux.html">Unix/Linux</a>
        </abbr>
    </footer>
    <section id="respond">
        <div id="disqus_thread">
        <script type="text/javascript">
        var disqus_identifier = "apache-httpd-and-tomcat-integration-using-mod_jk-part-1.html";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script>
        </div>

    </section>
</section>


        </section><!-- #content -->
        <section id="widgets" class="grid col-300 fit" >
            <!--
            <section id="widget-search" class="widget-wrapper widget_search">

                <form id="searchform" action="http://www.google.com/search" method="get">
                    <input id="q" class="field" type="text" placeholder="Search Blog" name="q" ></input>
                    <input id="ie" name="ie" type="hidden" value="utf-8" ></input>
                    <input id="oe" name="oe" type="hidden" value="utf-8" ></input>
                    <input id="channel" name="channel" type="hidden" value="suggest" ></input>
                    <input id="searchsubmit" class="submit" type="submit" value="">
                </form>
            </section>
            -->
            <section id="widget-category" class="widget-wrapper widget_archive">
                <div class="widget-title">
                    Category
                </div>
                <ul>
                        <li><a href="/category/family.html" >Family </a></li>
                        <li><a href="/category/java.html" >Java </a></li>
                        <li><a href="/category/renungan.html" >Renungan </a></li>
                        <li><a href="/category/telco.html" >Telco </a></li>
                        <li><a href="/category/travelling.html" >Travelling </a></li>
                        <li><a href="/category/unixlinux.html" >Unix/Linux </a></li>
                </ul>
            </section>

            <section id="widget-tagcloud" class="widget-wrapper widget_archive">
                <div class="widget-title">
                    Tagcloud
                </div>
                <div>
                        <span><a href="/tag/grand-angkasa.html">grand angkasa</a></span>
                        <span><a href="/tag/intelligent-network.html">Intelligent Network</a></span>
                        <span><a href="/tag/telco-billing.html">Telco Billing</a></span>
                        <span><a href="/tag/interconnect-telekomunikasi-telco-billing-interkoneksi.html">Interconnect Telekomunikasi Telco Billing Interkoneksi</a></span>
                        <span><a href="/tag/tips.html">Tips</a></span>
                        <span><a href="/tag/medan.html">medan</a></span>
                        <span><a href="/tag/prepaid-system.html">Prepaid System</a></span>
                        <span><a href="/tag/harare.html">harare</a></span>
                        <span><a href="/tag/tiara-medan.html">tiara medan</a></span>
                        <span><a href="/tag/zimbabwe.html">zimbabwe</a></span>
                        <span><a href="/tag/tips-unix-linux-stuff.html">Tips Unix Linux stuff</a></span>
                        <span><a href="/tag/laptop.html">Laptop</a></span>
                        <span><a href="/tag/renungan.html">Renungan</a></span>
                        <span><a href="/tag/grand-angkasa-medan.html">grand angkasa medan</a></span>
                        <span><a href="/tag/os-linux-stuff-opensolaris-solaris.html">OS Linux stuff OpenSolaris solaris</a></span>
                        <span><a href="/tag/martebe.html">martebe</a></span>
                        <span><a href="/tag/telco-billing-cdma-450-3g.html">Telco Billing CDMA 450 3G</a></span>
                        <span><a href="/tag/indonesian-embassy.html">indonesian embassy</a></span>
                        <span><a href="/tag/visa.html">VISA</a></span>
                        <span><a href="/tag/atutor-unix-linux-stuff-web-server-internet-nginx.html">aTutor Unix Linux stuff Web Server Internet Nginx</a></span>
                        <span><a href="/tag/broadband-at-home-internet-3g.html">Broadband at home Internet 3G</a></span>
                        <span><a href="/tag/ocs.html">OCS</a></span>
                        <span><a href="/tag/family.html">Family</a></span>
                        <span><a href="/tag/tips-unix-linux-stuff-web-server-nginx.html">Tips Unix Linux stuff Web Server Nginx</a></span>
                        <span><a href="/tag/ireland.html">Ireland</a></span>
                        <span><a href="/tag/charging-system.html">Charging System</a></span>
                        <span><a href="/tag/wordpress-verify-google-webmaster-internet.html">wordpress verify google webmaster Internet</a></span>
                        <span><a href="/tag/.html"></a></span>
                        <span><a href="/tag/merdeka-walk.html">merdeka walk</a></span>
                        <span><a href="/tag/embassy.html">embassy</a></span>
                        <span><a href="/tag/ruby-dsl-linux-stuff.html">Ruby DSL Linux stuff</a></span>
                        <span><a href="/tag/linux-stuff.html">Linux stuff</a></span>
                        <span><a href="/tag/green-card.html">Green Card</a></span>
                        <span><a href="/tag/cms.html">CMS</a></span>
                        <span><a href="/tag/lembur-kuring-medan.html">lembur kuring medan</a></span>
                        <span><a href="/tag/travel.html">Travel</a></span>
                        <span><a href="/tag/jumpstart-unix-linux-stuff-solaris.html">jumpstart Unix Linux stuff solaris</a></span>
                        <span><a href="/tag/brastagi.html">brastagi</a></span>
                </div>
            </section>


            <section id="widget-links" class="widget-wrapper widget_archive">
                <div class="widget-title">
                    Links
                </div>
                <ul>
                        <li><a href="http://getpelican.com/">Pelican</a></li>
                        <li><a href="http://python.org/">Python.org</a></li>
                        <li><a href="https://vhynaulia.wordpress.com/">Blognya TePot</a></li>
                        <li><a href="http://theprasojos.wordpress.com">Theprasojos Family</a></li>
                </ul>
            </section>
            
        </section><!-- widgets -->
    </section><!-- /#wrapper -->
    <footer id="footer" class="clearfix"><section class="footer-wrapper">
        <div class="grid col-940" >
            <div class="grid col-540"></div>
            <div class="grid col-380 fit" >
                <ul class="social-icons">
                    <!-- TO BE CONTINUED -->
                </ul>
            </div>
        </div>

        <div class="grid col-300 copyright" >
            <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license">
                <img src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" style="border-width:0" alt="知识共享许可协议"></img>
            </a>
        </div>
        <div class="grid col-300 ">

        </div>
        <div class="grid col-300 fit powered">
            Powered by <a href="http://getpelican.com/">Pelican</a> <br />
            which takes great advantage of <a href="http://python.org">Python</a>
        </div>
    </section></footer>
</div>
</body>
</html>