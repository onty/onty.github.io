<!doctype html>
<html class="no-js" lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<title>JPrasojo's blog</title>
		<meta name="description" content="">
		<meta name="author" content="Lintang JP">

		<link rel="stylesheet" href="http://blog.theprasojos.web.id/theme/css/foundation.css" />
		<link rel="stylesheet" href="http://blog.theprasojos.web.id/theme/css/pygment/monokai.css" />
		<link rel="stylesheet" href="http://blog.theprasojos.web.id/theme/css/custom.css" />


		<script src="http://blog.theprasojos.web.id/theme/js/modernizr.js"></script>

		<!-- Feeds -->
		<link href="http://blog.theprasojos.web.id/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="JPrasojo's blog Atom Feed" />

<script>var _gaq=[['_setAccount','UA-56589451-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>

		<!-- mathjax config similar to math.stackexchange -->
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			jax: ["input/TeX", "output/HTML-CSS"],
			tex2jax: {
				inlineMath: [ ['$', '$'] ],
				displayMath: [ ['$$', '$$']],
				processEscapes: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
			},
			messageStyle: "none",
			"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
		});
		</script>
		<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	</head>
	<body>
		<div class="off-canvas-wrap">
			<div class="inner-wrap">
				<!-- mobile top bar to activate nav -->
				<nav class="tab-bar show-for-small">
					<section class="left-small">
						<a class="left-off-canvas-toggle menu-icon" ><span></span></a>
					</section>

					<section class="middle tab-bar-section">
						<h1 class="title">JPrasojo's&nbsp;blog</h1>
					</section>
				</nav>

				<!-- mobile side bar nav -->
				<aside class="left-off-canvas-menu">
					<ul class="off-canvas-list">
						<li><a href="http://blog.theprasojos.web.id">Home</a></li>
						<li><label>Categories</label></li>
							<li ><a href="http://blog.theprasojos.web.id/category/family.html">Family</a></li>
							<li ><a href="http://blog.theprasojos.web.id/category/java.html">Java</a></li>
							<li ><a href="http://blog.theprasojos.web.id/category/renungan.html">Renungan</a></li>
							<li ><a href="http://blog.theprasojos.web.id/category/telco.html">Telco</a></li>
							<li ><a href="http://blog.theprasojos.web.id/category/travelling.html">Travelling</a></li>
							<li class="active"><a href="http://blog.theprasojos.web.id/category/unixlinux.html">Unix/Linux</a></li>

						<li><label>Places</label></li>
							<li><a href="http://getpelican.com/">Pelican</a></li>
							<li><a href="http://python.org/">Python.org</a></li>
							<li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
							<li><a href="http://theprasojos.wordpress.com">Theprasojos Family</a></li>


						<li><label>Monthly Archives</label></li>
									<li><a href="/2014/11/index.html">November 2014 (1)</a></li>
									<li><a href="/2014/10/index.html">October 2014 (1)</a></li>
									<li><a href="/2014/08/index.html">August 2014 (1)</a></li>
									<li><a href="/2014/07/index.html">July 2014 (1)</a></li>
									<li><a href="/2014/03/index.html">March 2014 (1)</a></li>
									<li><a href="/2011/02/index.html">February 2011 (1)</a></li>
									<li><a href="/2010/08/index.html">August 2010 (2)</a></li>
									<li><a href="/2010/04/index.html">April 2010 (1)</a></li>
									<li><a href="/2009/12/index.html">December 2009 (3)</a></li>
									<li><a href="/2009/05/index.html">May 2009 (1)</a></li>
									<li><a href="/2009/01/index.html">January 2009 (2)</a></li>
									<li><a href="/2008/12/index.html">December 2008 (3)</a></li>
									<li><a href="/2008/06/index.html">June 2008 (1)</a></li>
									<li><a href="/2008/03/index.html">March 2008 (1)</a></li>
									<li><a href="/2008/01/index.html">January 2008 (2)</a></li>
									<li><a href="/2007/12/index.html">December 2007 (1)</a></li>
									<li><a href="/2007/11/index.html">November 2007 (1)</a></li>
									<li><a href="/2007/08/index.html">August 2007 (1)</a></li>
									<li><a href="/2007/06/index.html">June 2007 (11)</a></li>
									<li><a href="/2007/05/index.html">May 2007 (2)</a></li>
									<li><a href="/2007/04/index.html">April 2007 (1)</a></li>
									<li><a href="/2006/04/index.html">April 2006 (2)</a></li>
									<li><a href="/2005/07/index.html">July 2005 (1)</a></li>
									<li><a href="/2005/06/index.html">June 2005 (3)</a></li>
									<li><a href="/2005/04/index.html">April 2005 (1)</a></li>
									<li><a href="/2005/03/index.html">March 2005 (1)</a></li>
									<li><a href="/2004/11/index.html">November 2004 (1)</a></li>
									<li><a href="/2004/10/index.html">October 2004 (2)</a></li>
									<li><a href="/2004/09/index.html">September 2004 (4)</a></li>
									<li><a href="/2004/08/index.html">August 2004 (1)</a></li>
									<li><a href="/2004/05/index.html">May 2004 (1)</a></li>

						<li><label>Links</label></li>
							<li><a href="https://www.linkedin.com/in/lintangprasojo">Linkedin</a></li>
							<li><a href="https://twitter.com/jprasojo">Twitter</a></li>
					</ul>	
				</aside>

				<!-- top bar nav -->
				<nav class="top-bar hide-for-small-only" data-topbar>
					<ul class="title-area">
						<li class="name">
							<h1><a href="http://blog.theprasojos.web.id/">JPrasojo's blog</a></h1>
						</li>
					</ul>

					<section class="top-bar-section">
						<ul class="left">
								<li ><a href="http://blog.theprasojos.web.id/category/family.html">Family</a></li>
								<li ><a href="http://blog.theprasojos.web.id/category/java.html">Java</a></li>
								<li ><a href="http://blog.theprasojos.web.id/category/renungan.html">Renungan</a></li>
								<li ><a href="http://blog.theprasojos.web.id/category/telco.html">Telco</a></li>
								<li ><a href="http://blog.theprasojos.web.id/category/travelling.html">Travelling</a></li>
								<li class="active"><a href="http://blog.theprasojos.web.id/category/unixlinux.html">Unix/Linux</a></li>
						</ul>
					</section>
				</nav>

				<!-- Main Page Content and Sidebar -->
				<section class="main-section">
					<div class="row">
						<!-- Main Content -->
						<div class="medium-9 small-12 columns" role="content">
<article>
	<h2>Quick guide on UNIX task scheduling with at and batch command</h2>
	<p>While task scheduling in UNIX commonly uses Crontab facilities, UNIX based system (actually, Windows provide it too, at.exe) also provide at command. Both related to the same area, task scheduling. While Crontab aims to schedule a recurring command (every minutes, every month, every week, etc), at command aims to schedule a task that run once, with specific time arguments. Here’s one example of how we can schedule a task with at command:</p>
<div class="highlight"><pre>$ <span class="n">at</span> <span class="n">now</span> <span class="mi">1</span> <span class="n">hour</span> <span class="nv">&amp;1</span> &gt; <span class="n">outfile</span> | <span class="n">mailx</span> <span class="n">mygroup</span>
!
<span class="n">commands</span> <span class="k">will</span> <span class="n">be</span> <span class="n">executed</span> <span class="n">using</span> /<span class="n">bin</span><span class="o">/</span><span class="n">tcsh</span>
<span class="n">job</span> <span class="mi">1242637613</span>.<span class="o">s</span> <span class="n">at</span> <span class="n">Mon</span> <span class="n">May</span> <span class="mi">18</span> <span class="mi">16</span>:<span class="mo">06</span>:<span class="mi">53</span> <span class="mi">2009</span>
</pre></div>


<p>As we can see from the example above, we want to schedule a task to be executed 1 hour from now, and the task to be executed is diff file1 file2 2&gt;&amp;1 &gt; outfile | mailx mygroup. The at command then returns the job id, which we will able to list all the queueing at command using atq or at –l below:</p>
<div class="highlight"><pre><span class="nv">$ </span>atq
Rank Execution Date Owner Job Queue Job Name
1st May 18, <span class="m">2009</span> 17:06 minsat 1242637774.a a stdin

<span class="nv">$ </span>at -l
1242637774.a Mon May <span class="m">18</span> 16:18:45 2009
</pre></div>


<p>From above we can see that there are only 1 jobs queuing at queue named ‘a’ (this is special queue name for at, and it is used to distinguish between the job executed by at and batch command). We can also see that the execution time will be May 18, 2009 17:06.</p>
<p>And to cancel the scheduled at command, we use atrm or at –r command as follows:</p>
<div class="highlight"><pre><span class="nv">$ </span>atrm 1242637774.a
1242637774.a: removed

<span class="nv">$ </span>at -r 1242637774.a
1242637774.a: removed
</pre></div>


<p>There are lots of other parameter we can use for describing the time parameter and how to execute the at command which is I found it quite ‘human readable’. Here’s some list of other possible parameter we can use:</p>
<p>1. Direct time</p>
<div class="highlight"><pre><span class="nv">$ </span>at 01.30
<span class="nv">$ </span>at 0815am Jan 24
<span class="nv">$ </span>at <span class="m">5</span> pm FRIday
</pre></div>


<p>2. Now keyword</p>
<div class="highlight"><pre><span class="nv">$ </span>at now <span class="m">1</span> minutes
<span class="nv">$ </span>at now <span class="m">1</span> hours
<span class="nv">$ </span>at now <span class="s2">&quot; 1day&quot;</span>
</pre></div>


<p>3. Tomorrow keyword</p>
<div class="highlight"><pre><span class="nv">$ </span>at <span class="m">0830</span> tomorrow
</pre></div>


<p>4. Noon keyword</p>
<div class="highlight"><pre><span class="nv">$ </span>at noon tomorrow
</pre></div>


<p>5. Midnight keyword</p>
<div class="highlight"><pre><span class="nv">$ </span>at midnight tomorrow
</pre></div>


<p>6. Week keyword</p>
<div class="highlight"><pre><span class="nv">$ </span>at 2pm next week
</pre></div>


<p>7. Piped with other command</p>
<div class="highlight"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;mail -s &#39;REMINDER: Task Scheduler samples&#39; lintang.jp@gmail.com&quot;</span> <span class="p">|</span> at <span class="s1">&#39;5/18/2009 10:00AM&#39;</span>
</pre></div>


<p>8. Putting the job inside a file</p>
<div class="highlight"><pre><span class="nv">$ </span>at –f runScript.sh now <span class="m">1</span> hour
</pre></div>


<p>9. Sending an email after the job is completed</p>
<div class="highlight"><pre><span class="nv">$ </span>at –m –f runScript.sh now <span class="m">1</span> hour
</pre></div>


<p>10. Using another shell instead of the user’s default shell for execution</p>
<div class="highlight"><pre><span class="nv">$ </span>at –c –f runScript.sh now <span class="m">1</span> week // C Shell
<span class="nv">$ </span>at –k –f runScript.sh now <span class="m">1</span> week // Korn Shell
<span class="nv">$ </span>at –s –f runScript.sh now <span class="m">1</span> week // Bourne Shell
</pre></div>


<p>Several behaviors and conditions that must be known when running at command as follows:</p>
<p>1. All environment variables, current working directory, file creation mask, and system resource limits during at utility execution will be retained and used when the at job is executed. So it’s different with Crontab where we have to set our environment variables manually to be called inside our script execution.
2. The default shell environment to be used during execution is the user’s default shell, listed in /etc/passwd.
3. Any users that is allowed or forbidden to use at command are listed in the following file :</p>
<p>1. /usr/lib/cron/at.deny // denied user
2. /usr/lib/cron/at.allow // allowed user</p>
<p>If the file does not exist, for example: at.allow file does not exist, means that all users are allowed to use at command.</p>
<p>While batch command is similar with at -q b -m now commands. Meaning that the batch command will use different queue with at (special queue named ‘b’), and by default it will send a report via email. It will also execute right away. If the queue is full, then the command will have to wait to be executed one by one.</p>
<p>Resource : 1. Unix at man pages, with some slang modifications :p</p>
<p>Fiuh, alhamdulillah, that was hard to wrote :D</p>
	<hr/>
	<h6>Written by <a href="http://blog.theprasojos.web.id/author/lintang-jp.html">Lintang JP</a> in <a href="http://blog.theprasojos.web.id/category/unixlinux.html">Unix/Linux</a> on Mon 18 May 2009. Tags: <a href="http://blog.theprasojos.web.id/tag/tips-unix-linux-stuff.html">Tips Unix Linux stuff</a>, </h6>
</article>

<hr/>
<div class="row">
	<div class="small-12 columns">
		<h3>Comments</h3>
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			var disqus_shortname = 'jprasojos';
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</div>
</div>
						</div>
						<!-- End Main Content -->
						<!-- Sidebar -->
						<aside class="medium-3 hide-for-small-only columns">
							<div class="panel">
								<h5>Places</h5>
								<ul class="side-nav">
									<li><a href="http://getpelican.com/">Pelican</a></li>
									<li><a href="http://python.org/">Python.org</a></li>
									<li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
									<li><a href="http://theprasojos.wordpress.com">Theprasojos Family</a></li>
								</ul>
							</div>

							<div class="panel">
								<h5>Tags</h5>
								<ul class="tag-cloud">
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/family.html">Family</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/charging-system.html">Charging System</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/martebe.html">martebe</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/harare.html">harare</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/indonesian-embassy.html">indonesian embassy</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/os-linux-stuff-opensolaris-solaris.html">OS Linux stuff OpenSolaris solaris</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/laptop.html">Laptop</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/ruby-dsl-linux-stuff.html">Ruby DSL Linux stuff</a></li>
										<li class="tag-1"><a href="http://blog.theprasojos.web.id/tag/.html"></a></li>
										<li class="tag-3"><a href="http://blog.theprasojos.web.id/tag/renungan.html">Renungan</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/atutor-unix-linux-stuff-web-server-internet-nginx.html">aTutor Unix Linux stuff Web Server Internet Nginx</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/broadband-at-home-internet-3g.html">Broadband at home Internet 3G</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/telco-billing-cdma-450-3g.html">Telco Billing CDMA 450 3G</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/travel.html">Travel</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/prepaid-system.html">Prepaid System</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/ireland.html">Ireland</a></li>
										<li class="tag-3"><a href="http://blog.theprasojos.web.id/tag/telco-billing.html">Telco Billing</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/embassy.html">embassy</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/lembur-kuring-medan.html">lembur kuring medan</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/tiara-medan.html">tiara medan</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/visa.html">VISA</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/merdeka-walk.html">merdeka walk</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/interconnect-telekomunikasi-telco-billing-interkoneksi.html">Interconnect Telekomunikasi Telco Billing Interkoneksi</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/grand-angkasa.html">grand angkasa</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/intelligent-network.html">Intelligent Network</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/jumpstart-unix-linux-stuff-solaris.html">jumpstart Unix Linux stuff solaris</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/green-card.html">Green Card</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/grand-angkasa-medan.html">grand angkasa medan</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/linux-stuff.html">Linux stuff</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/wordpress-verify-google-webmaster-internet.html">wordpress verify google webmaster Internet</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/zimbabwe.html">zimbabwe</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/tips.html">Tips</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/medan.html">medan</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/cms.html">CMS</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/tips-unix-linux-stuff-web-server-nginx.html">Tips Unix Linux stuff Web Server Nginx</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/brastagi.html">brastagi</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/ocs.html">OCS</a></li>
										<li class="tag-4"><a href="http://blog.theprasojos.web.id/tag/tips-unix-linux-stuff.html">Tips Unix Linux stuff</a></li>
								</ul>
							</div>

							<div class="panel">
								<h5>Monthly Archives</h5>
								<ul class="side-nav">
											<li><a href="/2014/11/index.html">November 2014 (1)</a></li>
											<li><a href="/2014/10/index.html">October 2014 (1)</a></li>
											<li><a href="/2014/08/index.html">August 2014 (1)</a></li>
											<li><a href="/2014/07/index.html">July 2014 (1)</a></li>
											<li><a href="/2014/03/index.html">March 2014 (1)</a></li>
											<li><a href="/2011/02/index.html">February 2011 (1)</a></li>
											<li><a href="/2010/08/index.html">August 2010 (2)</a></li>
											<li><a href="/2010/04/index.html">April 2010 (1)</a></li>
											<li><a href="/2009/12/index.html">December 2009 (3)</a></li>
											<li><a href="/2009/05/index.html">May 2009 (1)</a></li>
											<li><a href="/2009/01/index.html">January 2009 (2)</a></li>
											<li><a href="/2008/12/index.html">December 2008 (3)</a></li>
											<li><a href="/2008/06/index.html">June 2008 (1)</a></li>
											<li><a href="/2008/03/index.html">March 2008 (1)</a></li>
											<li><a href="/2008/01/index.html">January 2008 (2)</a></li>
											<li><a href="/2007/12/index.html">December 2007 (1)</a></li>
											<li><a href="/2007/11/index.html">November 2007 (1)</a></li>
											<li><a href="/2007/08/index.html">August 2007 (1)</a></li>
											<li><a href="/2007/06/index.html">June 2007 (11)</a></li>
											<li><a href="/2007/05/index.html">May 2007 (2)</a></li>
											<li><a href="/2007/04/index.html">April 2007 (1)</a></li>
											<li><a href="/2006/04/index.html">April 2006 (2)</a></li>
											<li><a href="/2005/07/index.html">July 2005 (1)</a></li>
											<li><a href="/2005/06/index.html">June 2005 (3)</a></li>
											<li><a href="/2005/04/index.html">April 2005 (1)</a></li>
											<li><a href="/2005/03/index.html">March 2005 (1)</a></li>
											<li><a href="/2004/11/index.html">November 2004 (1)</a></li>
											<li><a href="/2004/10/index.html">October 2004 (2)</a></li>
											<li><a href="/2004/09/index.html">September 2004 (4)</a></li>
											<li><a href="/2004/08/index.html">August 2004 (1)</a></li>
											<li><a href="/2004/05/index.html">May 2004 (1)</a></li>
								</ul>
							</div>

							<div class="panel">
								<h5>Links</h5>
								<ul class="side-nav">
									<li><a href="https://www.linkedin.com/in/lintangprasojo">Linkedin</a></li>
									<li><a href="https://twitter.com/jprasojo">Twitter</a></li>
								</ul>
							</div>
						</aside>
						<!-- End Sidebar -->
					</div>

					<!-- Footer -->
					<footer class="row">
						<div class="medium-9 small-12">
							<hr/>
							<p class="text-center">Powered by <a href="http://getpelican.com">Pelican</a> and <a href="http://foundation.zurb.com/">Zurb Foundation</a>. Theme by <a href="http://hamaluik.com">Kenton Hamaluik</a>.</p>
						</div>
					</footer>
					<!-- End Footer -->
				</section>
				<a class="exit-off-canvas"></a>
			</div><!--off-canvas inner-->
		</div><!--off-canvas wrap-->

		<script src="http://blog.theprasojos.web.id/theme/js/jquery.js"></script>
		<script src="http://blog.theprasojos.web.id/theme/js/foundation.min.js"></script>
		<script>
			$(document).foundation();
		</script>
	</body>
</html>